<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Cost-Effectiveness Applications • dynamicpv</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Cost-Effectiveness Applications">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">dynamicpv</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/budget-impact-applications.html">Budget Impact Applications</a></li>
    <li><a class="dropdown-item" href="../articles/cost-effectiveness-applications.html">Cost-Effectiveness Applications</a></li>
    <li><a class="dropdown-item" href="../articles/math-framework.html">Mathematical Framework</a></li>
    <li><a class="dropdown-item" href="../articles/net-present-value.html">Net Present Value</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/MSDLLCpapers/dynamicpv/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Cost-Effectiveness Applications</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/MSDLLCpapers/dynamicpv/blob/main/vignettes/cost-effectiveness-applications.Rmd" class="external-link"><code>vignettes/cost-effectiveness-applications.Rmd</code></a></small>
      <div class="d-none name"><code>cost-effectiveness-applications.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette outlines how to evaluate a cost-effectiveness model in
a manner that allows for dynamic pricing and dynamic uptake. Let us
consider in turn:</p>
<ul>
<li>the decision problem we are modeling through a cost-effectiveness
analysis</li>
<li>dynamic patient uptake</li>
<li>dynamic pricing</li>
</ul>
</div>
<div class="section level2">
<h2 id="methods-and-assumptions">Methods and Assumptions<a class="anchor" aria-label="anchor" href="#methods-and-assumptions"></a>
</h2>
<p>We wish to evaluate the cost-effectiveness, measured as incremental
cost per QALY, of a new intervention compared to the standard of care
(SoC). The model is a partitioned survival analysis typical in oncology
with three health states: progression-free (PF), progressive disease
(PD) and death, with additional assumptions as follows.</p>
<div class="section level3">
<h3 id="general-assumptions">General assumptions<a class="anchor" aria-label="anchor" href="#general-assumptions"></a>
</h3>
<ul>
<li>The time horizon is 20 years, a timestep is 1 week, discounting is
at 3% per year, with an effective date of calculation is
2025-06-01.</li>
<li>For SoC, progression-free survival (PFS) is modeled as an
exponential distribution with mean of 50 weeks; overall survival (OS) in
weeks is modelled according to a lognormal distribution with mean and
standard deviation on the log scale as 4 and 1 respectively.</li>
<li>The effect of the new intervention relative to the SoC is a hazard
ratio of 0.5 on PFS and 0.6 on OS.</li>
<li>Health utility is 0.8 in the PF state and 0.6 in the PD state.</li>
<li>Drug acquisition costs are $400 and $1500 per week for SoC and the
new intervention respectively, incurred throughout a patient’s time in
the PF state (treat to progression).</li>
<li>Drug administration costs are $50 and $75 per week on treatment for
SoC and the new intervention respectively.</li>
<li>Adverse events occur in 0.08% and 0.10% of SoC and new intervention
patients per week respectively, while on treatment, at an average cost
of $2000 per event.</li>
<li>Disease management costs are $80 per week in PF and $20 per week in
PD.</li>
<li>Patients receive the treatment of interest (new or SoC) until
progression. Subsequent treatment costs are $1200 and $300 per week per
patient while in the PD state for SoC and new intervention patients
respectively.</li>
</ul>
</div>
<div class="section level3">
<h3 id="dynamic-pricing">Dynamic pricing<a class="anchor" aria-label="anchor" href="#dynamic-pricing"></a>
</h3>
<p>Let us suppose the following assumptions concerning pricing:</p>
<ul>
<li>Costs are assumed to increases in line with general inflation (2.5%
per year), except for effects on drug acquisition costs due to
LoEs.</li>
<li>The date of calculation is 2025-09-01.</li>
<li>The LoE for the SoC is assumed to occur first, at 2028-01-01, after
which there is anticipated to be a 70% reduction in prices over one
year.</li>
<li>The new intervention has an LoE occuring three years later, at
2031-01-01, after which there would be a 50% reduction in prices over
one year.</li>
</ul>
</div>
<div class="section level3">
<h3 id="dynamic-uptake">Dynamic uptake<a class="anchor" aria-label="anchor" href="#dynamic-uptake"></a>
</h3>
<p>Let us suppose the following assumptions concerning patient uptake.
The aim here is to estimate the incidence of patients for whom the
decision problem applies, i.e. the patients who would receive the new
intervention, were it made available. This will be a function of, but
not the same as, disease incidence or prevalence. We assume:</p>
<ul>
<li>Only newly incident patients with the cancer being modeled would be
eligible for the new treatment. Existing/prevalent patients with the
condition would not be eligible.</li>
<li>The disease incidence is 1 patient per week.</li>
<li>Among these patients, were the new intervention to be made
available, uptake of the new intervention would be expected to rise
linearly from 0% to 100% after 2 years.</li>
</ul>
<p>In this way, uptake would be gradually increasing with time,
accounting for disease epidemiology and the share of patients who
receive the new intervention.</p>
</div>
</div>
<div class="section level2">
<h2 id="implementation">Implementation<a class="anchor" aria-label="anchor" href="#implementation"></a>
</h2>
<div class="section level3">
<h3 id="set-up">Set-up<a class="anchor" aria-label="anchor" href="#set-up"></a>
</h3>
<p>First we load the packages necessary for this vignette.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org" class="external-link">lubridate</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/chjackson/flexsurv" class="external-link">flexsurv</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://aphp.github.io/heemod/" class="external-link">heemod</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://MSDLLCpapers.github.io/dynamicpv/">dynamicpv</a></span><span class="op">)</span></span></code></pre></div>
<p>We code the time constants, time horizon, discount rates and
inflation rates first.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Time constants</span></span>
<span><span class="va">days_in_year</span> <span class="op">&lt;-</span> <span class="fl">365.25</span></span>
<span><span class="va">days_in_week</span> <span class="op">&lt;-</span> <span class="fl">7</span></span>
<span><span class="va">cycle_years</span> <span class="op">&lt;-</span> <span class="va">days_in_week</span> <span class="op">/</span> <span class="va">days_in_year</span> <span class="co"># Duration of a one week cycle in years</span></span>
<span></span>
<span><span class="co"># Time horizon (years) and number of cycles</span></span>
<span><span class="va">thoz</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span><span class="va">Ncycles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="va">thoz</span><span class="op">/</span><span class="va">cycle_years</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Real discounting</span></span>
<span><span class="va">disc_year</span> <span class="op">&lt;-</span> <span class="fl">0.03</span> <span class="co"># Per year</span></span>
<span><span class="va">disc_cycle</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">disc_year</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="va">cycle_years</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span> <span class="co"># Per cycle</span></span>
<span></span>
<span><span class="co"># Price inflation</span></span>
<span><span class="va">infl_year</span> <span class="op">&lt;-</span> <span class="fl">0.025</span> <span class="co"># Per year</span></span>
<span><span class="va">infl_cycle</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">infl_year</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="va">cycle_years</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span> <span class="co"># Per cycle</span></span>
<span></span>
<span><span class="co"># Nominal discounting</span></span>
<span><span class="va">nomdisc_year</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">disc_year</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">infl_year</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span></span>
<span><span class="va">nomdisc_cycle</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">nomdisc_year</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="va">cycle_years</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span> <span class="co"># Per cycle</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="cost-effectiveness-model">Cost-effectiveness model<a class="anchor" aria-label="anchor" href="#cost-effectiveness-model"></a>
</h3>
<p>The cost-effectiveness model may then be coded in <a href="https://cran.r-project.org/package=heemod" class="external-link">heemod</a> as
follows.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># State names</span></span>
<span><span class="va">state_names</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  progression_free <span class="op">=</span> <span class="st">"PF"</span>,</span>
<span>  progression <span class="op">=</span> <span class="st">"PD"</span>,</span>
<span>  death <span class="op">=</span> <span class="st">"Death"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># PFS distribution for SoC with Exp() distribution and mean of 50 weeks</span></span>
<span><span class="va">surv_pfs_soc</span> <span class="op">&lt;-</span> <span class="fu">heemod</span><span class="fu">::</span><span class="fu"><a href="https://aphp.github.io/heemod/reference/define_surv_dist.html" class="external-link">define_surv_dist</a></span><span class="op">(</span></span>
<span>  distribution <span class="op">=</span> <span class="st">"exp"</span>,</span>
<span>  rate <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">50</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># OS distribution for SoC with Lognorm() distribution, meanlog = 4.5, sdlog = 1</span></span>
<span><span class="co"># This implies a mean of exp(4 + 0.5 * 1^2) = exp(4.5) = 90 weeks</span></span>
<span><span class="va">surv_os_soc</span> <span class="op">&lt;-</span> <span class="fu">heemod</span><span class="fu">::</span><span class="fu"><a href="https://aphp.github.io/heemod/reference/define_surv_dist.html" class="external-link">define_surv_dist</a></span><span class="op">(</span></span>
<span>  distribution <span class="op">=</span> <span class="st">"lnorm"</span>,</span>
<span>  meanlog <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  sdlog <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># PFS and OS distributions for new</span></span>
<span><span class="va">surv_pfs_new</span> <span class="op">&lt;-</span> <span class="fu">heemod</span><span class="fu">::</span><span class="fu"><a href="https://aphp.github.io/heemod/reference/apply_hr.html" class="external-link">apply_hr</a></span><span class="op">(</span><span class="va">surv_pfs_soc</span>, hr<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">surv_os_new</span> <span class="op">&lt;-</span> <span class="fu">heemod</span><span class="fu">::</span><span class="fu"><a href="https://aphp.github.io/heemod/reference/apply_hr.html" class="external-link">apply_hr</a></span><span class="op">(</span><span class="va">surv_os_soc</span>, hr<span class="op">=</span><span class="fl">0.6</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define partitioned survival model, soc</span></span>
<span><span class="va">psm_soc</span> <span class="op">&lt;-</span> <span class="fu">heemod</span><span class="fu">::</span><span class="fu"><a href="https://aphp.github.io/heemod/reference/define_part_surv.html" class="external-link">define_part_surv</a></span><span class="op">(</span></span>
<span>  pfs <span class="op">=</span> <span class="va">surv_pfs_soc</span>,</span>
<span>  os <span class="op">=</span> <span class="va">surv_os_soc</span>,</span>
<span>  terminal_state <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  state_names <span class="op">=</span> <span class="va">state_names</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Define partitioned survival model, soc</span></span>
<span><span class="va">psm_new</span> <span class="op">&lt;-</span> <span class="fu">heemod</span><span class="fu">::</span><span class="fu"><a href="https://aphp.github.io/heemod/reference/define_part_surv.html" class="external-link">define_part_surv</a></span><span class="op">(</span></span>
<span>  pfs <span class="op">=</span> <span class="va">surv_pfs_new</span>,</span>
<span>  os <span class="op">=</span> <span class="va">surv_os_new</span>,</span>
<span>  terminal_state <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  state_names <span class="op">=</span> <span class="va">state_names</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Parameters</span></span>
<span><span class="va">params</span> <span class="op">&lt;-</span> <span class="fu">heemod</span><span class="fu">::</span><span class="fu"><a href="https://aphp.github.io/heemod/reference/define_parameters.html" class="external-link">define_parameters</a></span><span class="op">(</span></span>
<span>  <span class="co"># Discount rate</span></span>
<span>  disc <span class="op">=</span> <span class="va">disc_cycle</span>,</span>
<span>  <span class="co"># Disease management costs</span></span>
<span>  cman_pf <span class="op">=</span> <span class="fl">80</span>,</span>
<span>  cman_pd <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  <span class="co"># Drug acquisition costs - the SoC regime only uses SoC drug, the New regime only uses New drug</span></span>
<span>  cdaq_soc <span class="op">=</span> <span class="fu"><a href="https://aphp.github.io/heemod/reference/dispatch_strategy.html" class="external-link">dispatch_strategy</a></span><span class="op">(</span></span>
<span>    soc <span class="op">=</span> <span class="fl">400</span>,</span>
<span>    new <span class="op">=</span> <span class="fl">0</span></span>
<span>  <span class="op">)</span>,</span>
<span>  cdaq_new <span class="op">=</span> <span class="fu"><a href="https://aphp.github.io/heemod/reference/dispatch_strategy.html" class="external-link">dispatch_strategy</a></span><span class="op">(</span></span>
<span>    soc <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    new <span class="op">=</span> <span class="fl">1500</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="co"># Drug administration costs</span></span>
<span>  cadmin <span class="op">=</span> <span class="fu"><a href="https://aphp.github.io/heemod/reference/dispatch_strategy.html" class="external-link">dispatch_strategy</a></span><span class="op">(</span></span>
<span>    soc <span class="op">=</span> <span class="fl">50</span>,</span>
<span>    new <span class="op">=</span> <span class="fl">75</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="co"># Adverse event risks</span></span>
<span>  risk_ae <span class="op">=</span> <span class="fu"><a href="https://aphp.github.io/heemod/reference/dispatch_strategy.html" class="external-link">dispatch_strategy</a></span><span class="op">(</span></span>
<span>    soc <span class="op">=</span> <span class="fl">0.08</span>,</span>
<span>    new <span class="op">=</span> <span class="fl">0.1</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="co"># Adverse event average costs</span></span>
<span>  uc_ae <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>  <span class="co"># Subsequent treatments</span></span>
<span>  csubs <span class="op">=</span> <span class="fu"><a href="https://aphp.github.io/heemod/reference/dispatch_strategy.html" class="external-link">dispatch_strategy</a></span><span class="op">(</span></span>
<span>    soc <span class="op">=</span> <span class="fl">1200</span>,</span>
<span>    new <span class="op">=</span> <span class="fl">300</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="co"># Health state utilities</span></span>
<span>  u_pf <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  u_pd <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define PF states</span></span>
<span><span class="va">state_PF</span> <span class="op">&lt;-</span> <span class="fu">heemod</span><span class="fu">::</span><span class="fu"><a href="https://aphp.github.io/heemod/reference/define_state.html" class="external-link">define_state</a></span><span class="op">(</span></span>
<span>  <span class="co"># Costs for the state</span></span>
<span>  cost_daq_soc <span class="op">=</span> <span class="fu"><a href="https://aphp.github.io/heemod/reference/discount.html" class="external-link">discount</a></span><span class="op">(</span><span class="va">cdaq_soc</span>, <span class="va">disc_cycle</span><span class="op">)</span>,</span>
<span>  cost_daq_new <span class="op">=</span> <span class="fu"><a href="https://aphp.github.io/heemod/reference/discount.html" class="external-link">discount</a></span><span class="op">(</span><span class="va">cdaq_new</span>, <span class="va">disc_cycle</span><span class="op">)</span>,</span>
<span>  cost_dadmin <span class="op">=</span> <span class="fu"><a href="https://aphp.github.io/heemod/reference/discount.html" class="external-link">discount</a></span><span class="op">(</span><span class="va">cadmin</span>, <span class="va">disc_cycle</span><span class="op">)</span>,</span>
<span>  cost_dman <span class="op">=</span> <span class="fu"><a href="https://aphp.github.io/heemod/reference/discount.html" class="external-link">discount</a></span><span class="op">(</span><span class="va">cman_pf</span>, <span class="va">disc_cycle</span><span class="op">)</span>,  </span>
<span>  cost_ae <span class="op">=</span> <span class="va">risk_ae</span> <span class="op">*</span> <span class="va">uc_ae</span>,</span>
<span>  cost_subs <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  cost_total <span class="op">=</span> <span class="va">cost_daq_soc</span> <span class="op">+</span> <span class="va">cost_daq_new</span> <span class="op">+</span> <span class="va">cost_dadmin</span> <span class="op">+</span> <span class="va">cost_dman</span> <span class="op">+</span> <span class="va">cost_ae</span> <span class="op">+</span> <span class="va">cost_subs</span>,</span>
<span>  <span class="co"># Health utility, QALYs and life years</span></span>
<span>  pf_year <span class="op">=</span> <span class="fu"><a href="https://aphp.github.io/heemod/reference/discount.html" class="external-link">discount</a></span><span class="op">(</span><span class="va">cycle_years</span>, <span class="va">disc_cycle</span><span class="op">)</span>,</span>
<span>  life_year <span class="op">=</span> <span class="fu"><a href="https://aphp.github.io/heemod/reference/discount.html" class="external-link">discount</a></span><span class="op">(</span><span class="va">cycle_years</span>, <span class="va">disc_cycle</span><span class="op">)</span>,</span>
<span>  qaly <span class="op">=</span> <span class="fu"><a href="https://aphp.github.io/heemod/reference/discount.html" class="external-link">discount</a></span><span class="op">(</span><span class="va">cycle_years</span> <span class="op">*</span> <span class="va">u_pf</span>, <span class="va">disc_cycle</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Define PD states</span></span>
<span><span class="va">state_PD</span> <span class="op">&lt;-</span> <span class="fu">heemod</span><span class="fu">::</span><span class="fu"><a href="https://aphp.github.io/heemod/reference/define_state.html" class="external-link">define_state</a></span><span class="op">(</span></span>
<span>  <span class="co"># Costs for the state</span></span>
<span>  cost_daq_soc <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  cost_daq_new <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  cost_dadmin <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  cost_dman <span class="op">=</span> <span class="fu"><a href="https://aphp.github.io/heemod/reference/discount.html" class="external-link">discount</a></span><span class="op">(</span><span class="va">cman_pd</span>, <span class="va">disc_cycle</span><span class="op">)</span>,  </span>
<span>  cost_ae <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  cost_subs <span class="op">=</span> <span class="fu"><a href="https://aphp.github.io/heemod/reference/discount.html" class="external-link">discount</a></span><span class="op">(</span><span class="va">csubs</span>, <span class="va">disc_cycle</span><span class="op">)</span>,</span>
<span>  cost_total <span class="op">=</span> <span class="va">cost_daq_soc</span> <span class="op">+</span> <span class="va">cost_daq_new</span> <span class="op">+</span> <span class="va">cost_dadmin</span> <span class="op">+</span> <span class="va">cost_dman</span> <span class="op">+</span> <span class="va">cost_ae</span> <span class="op">+</span> <span class="va">cost_subs</span>,</span>
<span>  <span class="co"># Health utility, QALYs and life years</span></span>
<span>  pf_year <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  life_year <span class="op">=</span> <span class="fu">heemod</span><span class="fu">::</span><span class="fu"><a href="https://aphp.github.io/heemod/reference/discount.html" class="external-link">discount</a></span><span class="op">(</span><span class="va">cycle_years</span>, <span class="va">disc_cycle</span><span class="op">)</span>,</span>
<span>  qaly <span class="op">=</span> <span class="fu">heemod</span><span class="fu">::</span><span class="fu"><a href="https://aphp.github.io/heemod/reference/discount.html" class="external-link">discount</a></span><span class="op">(</span><span class="va">cycle_years</span> <span class="op">*</span> <span class="va">u_pd</span>, <span class="va">disc_cycle</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Define Death state</span></span>
<span><span class="va">state_Death</span> <span class="op">&lt;-</span> <span class="fu">heemod</span><span class="fu">::</span><span class="fu"><a href="https://aphp.github.io/heemod/reference/define_state.html" class="external-link">define_state</a></span><span class="op">(</span></span>
<span>  <span class="co"># Costs are zero</span></span>
<span>  cost_daq_soc <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  cost_daq_new <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  cost_dadmin <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  cost_dman <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  cost_ae <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  cost_subs <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  cost_total <span class="op">=</span> <span class="va">cost_daq_soc</span> <span class="op">+</span> <span class="va">cost_daq_new</span> <span class="op">+</span> <span class="va">cost_dadmin</span> <span class="op">+</span> <span class="va">cost_dman</span> <span class="op">+</span> <span class="va">cost_ae</span> <span class="op">+</span> <span class="va">cost_subs</span>,</span>
<span>  <span class="co"># Health outcomes are zero</span></span>
<span>  pf_year <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  life_year <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  qaly <span class="op">=</span> <span class="fl">0</span>,</span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define strategy for SoC</span></span>
<span><span class="va">strat_soc</span> <span class="op">&lt;-</span> <span class="fu">heemod</span><span class="fu">::</span><span class="fu"><a href="https://aphp.github.io/heemod/reference/define_strategy.html" class="external-link">define_strategy</a></span><span class="op">(</span></span>
<span>    transition <span class="op">=</span> <span class="va">psm_soc</span>,</span>
<span>    <span class="st">"PF"</span> <span class="op">=</span> <span class="va">state_PF</span>,</span>
<span>    <span class="st">"PD"</span> <span class="op">=</span> <span class="va">state_PD</span>,</span>
<span>    <span class="st">"Death"</span> <span class="op">=</span> <span class="va">state_Death</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Define strategy for new</span></span>
<span><span class="va">strat_new</span> <span class="op">&lt;-</span> <span class="fu">heemod</span><span class="fu">::</span><span class="fu"><a href="https://aphp.github.io/heemod/reference/define_strategy.html" class="external-link">define_strategy</a></span><span class="op">(</span></span>
<span>  transition <span class="op">=</span> <span class="va">psm_new</span>,</span>
<span>  <span class="st">"PF"</span> <span class="op">=</span> <span class="va">state_PF</span>,</span>
<span>  <span class="st">"PD"</span> <span class="op">=</span> <span class="va">state_PD</span>,</span>
<span>  <span class="st">"Death"</span> <span class="op">=</span> <span class="va">state_Death</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create heemod model</span></span>
<span><span class="va">heemodel</span> <span class="op">&lt;-</span> <span class="fu">heemod</span><span class="fu">::</span><span class="fu"><a href="https://aphp.github.io/heemod/reference/run_model.html" class="external-link">run_model</a></span><span class="op">(</span></span>
<span>  soc <span class="op">=</span> <span class="va">strat_soc</span>,</span>
<span>  new <span class="op">=</span> <span class="va">strat_new</span>,</span>
<span>  parameters <span class="op">=</span> <span class="va">params</span>,</span>
<span>  cycles <span class="op">=</span> <span class="va">Ncycles</span>,</span>
<span>  cost <span class="op">=</span> <span class="va">cost_total</span>,</span>
<span>  effect <span class="op">=</span> <span class="va">qaly</span>,</span>
<span>  init <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"life-table"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="dynamic-pricing-1">Dynamic pricing<a class="anchor" aria-label="anchor" href="#dynamic-pricing-1"></a>
</h3>
<p>The dynamic pricing assumptions can be codified as follows.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Dates</span></span>
<span><span class="co"># Date of calculation = 1 September 2025</span></span>
<span><span class="va">doc</span> <span class="op">&lt;-</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="st">"20250901"</span><span class="op">)</span></span>
<span><span class="co"># Date of LOE for SoC = 1 January 2028</span></span>
<span><span class="va">loe_soc_start</span> <span class="op">&lt;-</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="st">"20280101"</span><span class="op">)</span></span>
<span><span class="co"># Maturation of SoC prices by LOE + 1 year, i.e. = 1 January 2029</span></span>
<span><span class="va">loe_soc_end</span> <span class="op">&lt;-</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="st">"20290101"</span><span class="op">)</span> </span>
<span><span class="co"># Date of LOE for new treatment = 1 January 2031</span></span>
<span><span class="va">loe_new_start</span> <span class="op">&lt;-</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="st">"20310101"</span><span class="op">)</span></span>
<span><span class="co"># Maturation of new treatment prices by LOE + 1 year, i.e. = 1 January 2032</span></span>
<span><span class="va">loe_new_end</span> <span class="op">&lt;-</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="st">"20320101"</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># Effect of LoEs on prices once mature</span></span>
<span><span class="va">loe_effect_soc</span> <span class="op">&lt;-</span> <span class="fl">0.7</span></span>
<span><span class="va">loe_effect_new</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span></span>
<span><span class="co"># Calculation of weeks since DoC for LoEs and price maturities</span></span>
<span><span class="va">wk_start_soc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="op">(</span><span class="va">loe_soc_start</span><span class="op">-</span><span class="va">doc</span><span class="op">)</span> <span class="op">/</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/duration.html" class="external-link">dweeks</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">wk_end_soc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="op">(</span><span class="va">loe_soc_end</span><span class="op">-</span><span class="va">doc</span><span class="op">)</span> <span class="op">/</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/duration.html" class="external-link">dweeks</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">wk_start_new</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="op">(</span><span class="va">loe_new_start</span><span class="op">-</span><span class="va">doc</span><span class="op">)</span> <span class="op">/</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/duration.html" class="external-link">dweeks</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">wk_end_new</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="op">(</span><span class="va">loe_new_end</span><span class="op">-</span><span class="va">doc</span><span class="op">)</span> <span class="op">/</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/duration.html" class="external-link">dweeks</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Price maturity times</span></span>
<span><span class="va">wk_mature_soc</span> <span class="op">&lt;-</span> <span class="va">wk_end_soc</span> <span class="op">-</span> <span class="va">wk_start_soc</span></span>
<span><span class="va">wk_mature_new</span> <span class="op">&lt;-</span> <span class="va">wk_end_new</span> <span class="op">-</span> <span class="va">wk_start_new</span></span>
<span></span>
<span><span class="co"># Create a tibble of price indices of length 2T, then pull out columns as needed</span></span>
<span><span class="co"># We only need of length T for now, but need of length 2T for future calculations later</span></span>
<span><span class="va">pricetib</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  model_time <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">Ncycles</span><span class="op">)</span>,</span>
<span>  model_year <span class="op">=</span> <span class="va">model_time</span> <span class="op">*</span> <span class="va">cycle_years</span>,</span>
<span>  static <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  geninfl <span class="op">=</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">infl_cycle</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="va">model_time</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  loef_soc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmin</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmax</a></span><span class="op">(</span><span class="va">model_time</span> <span class="op">-</span> <span class="va">wk_start_soc</span>, <span class="fl">0</span><span class="op">)</span>, <span class="va">wk_mature_soc</span><span class="op">)</span> <span class="op">/</span> <span class="va">wk_mature_soc</span>,</span>
<span>  loef_new <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmin</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmax</a></span><span class="op">(</span><span class="va">model_time</span> <span class="op">-</span> <span class="va">wk_start_new</span>, <span class="fl">0</span><span class="op">)</span>, <span class="va">wk_mature_new</span><span class="op">)</span> <span class="op">/</span> <span class="va">wk_mature_new</span>,</span>
<span>  dyn_soc <span class="op">=</span> <span class="va">geninfl</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">loe_effect_soc</span> <span class="op">*</span> <span class="va">loef_soc</span><span class="op">)</span>,</span>
<span>  dyn_new <span class="op">=</span> <span class="va">geninfl</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">loe_effect_new</span> <span class="op">*</span> <span class="va">loef_new</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Price indices required for calculations</span></span>
<span><span class="va">prices_oth</span> <span class="op">&lt;-</span> <span class="va">pricetib</span><span class="op">$</span><span class="va">geninfl</span></span>
<span><span class="va">prices_static</span> <span class="op">&lt;-</span> <span class="va">pricetib</span><span class="op">$</span><span class="va">static</span></span>
<span><span class="va">prices_dyn_soc</span> <span class="op">&lt;-</span> <span class="va">pricetib</span><span class="op">$</span><span class="va">dyn_soc</span></span>
<span><span class="va">prices_dyn_new</span> <span class="op">&lt;-</span> <span class="va">pricetib</span><span class="op">$</span><span class="va">dyn_new</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="dynamic-uptake-1">Dynamic uptake<a class="anchor" aria-label="anchor" href="#dynamic-uptake-1"></a>
</h3>
<p>The dynamic uptake assumptions can be codified as follows.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Time for uptake to occur</span></span>
<span><span class="va">uptake_years</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span></span>
<span><span class="co"># Uptake vector for non-dynamic uptake</span></span>
<span><span class="va">uptake_single</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">Ncycles</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Uptake vector for dynamic uptake</span></span>
<span><span class="va">uptake_weeks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">uptake_years</span> <span class="op">/</span> <span class="va">cycle_years</span><span class="op">)</span></span>
<span><span class="va">share_multi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">uptake_weeks</span><span class="op">)</span><span class="op">/</span><span class="va">uptake_weeks</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">Ncycles</span><span class="op">-</span><span class="va">uptake_weeks</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">uptake_multi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">Ncycles</span><span class="op">)</span> <span class="op">*</span> <span class="va">share_multi</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="results">Results<a class="anchor" aria-label="anchor" href="#results"></a>
</h2>
<div class="section level3">
<h3 id="without-dynamic-pricing-or-dynamic-uptake">Without dynamic pricing or dynamic uptake<a class="anchor" aria-label="anchor" href="#without-dynamic-pricing-or-dynamic-uptake"></a>
</h3>
<p>The conventional cost-effectiveness model is static.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">heemodel</span></span>
<span><span class="co">#&gt; 2 strategies run for 1044 cycles.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Initial state counts:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; PF = 1</span></span>
<span><span class="co">#&gt; PD = 0</span></span>
<span><span class="co">#&gt; Death = 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Counting method: 'life-table'.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Values:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     cost_daq_soc cost_daq_new cost_dadmin cost_dman   cost_ae cost_subs</span></span>
<span><span class="co">#&gt; soc     19455.25          0.0    2431.906  4601.624  8000.267  42634.43</span></span>
<span><span class="co">#&gt; new         0.00     141997.2    7099.860  8666.132 19999.582  16394.22</span></span>
<span><span class="co">#&gt;     cost_total   pf_year life_year     qaly</span></span>
<span><span class="co">#&gt; soc   77123.47 0.9321475  1.613053 1.154261</span></span>
<span><span class="co">#&gt; new  194156.99 1.8142467  2.861562 2.079786</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Efficiency frontier:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; soc -&gt; new</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Differences:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Cost Diff. Effect Diff.   ICER Ref.</span></span>
<span><span class="co">#&gt; new   117033.5    0.9255249 126451  soc</span></span></code></pre></div>
<p>Let’s examine each payoff more closely. The next steps extract a
payoff vector from the model object. The model/object contains several
payoffs accumulated in each timestep, calculated as at time zero:</p>
<ul>
<li>drug acquisition cost of the standard of care
(<em>cost_daq_soc</em>),</li>
<li>drug acquisition cost of the new intervention
(<em>cost_daq_new</em>),</li>
<li>cost of drug administration (<em>cost_dadmin</em>),</li>
<li>cost of disease management (<em>cost_dman</em>),</li>
<li>cost of treating adverse events (<em>cost_ae</em>),</li>
<li>cost of subsequent lines of treatment (<em>cost_subs</em>),</li>
<li>total cost (<em>cost_total</em>),</li>
<li>progression-free life years (<em>pf_year</em>),</li>
<li>life years (<em>life_year</em>), and</li>
<li>QALYs (<em>qaly</em>).</li>
</ul>
<p>The <code><a href="../reference/get_dynfields.html">dynamicpv::get_dynfields()</a></code> function extracts these
parameters from the <a href="https://cran.r-project.org/package=heemod" class="external-link">heemod</a> model
object, and calculates ‘rolled-up’ values as at the start of each
timestep rather than discounted to time zero. The rolled-up values are
what <code><a href="../reference/dynpv.html">dynamicpv::dynpv()</a></code> requires.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Pull out the payoffs of interest from oncpsm</span></span>
<span><span class="va">payoffs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_dynfields.html">get_dynfields</a></span><span class="op">(</span></span>
<span>    heemodel <span class="op">=</span> <span class="va">heemodel</span>,</span>
<span>    payoffs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cost_daq_new"</span>, <span class="st">"cost_daq_soc"</span>, <span class="st">"cost_total"</span>, <span class="st">"qaly"</span>, <span class="st">"life_year"</span><span class="op">)</span>,</span>
<span>    discount <span class="op">=</span> <span class="st">"disc"</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>      model_years <span class="op">=</span> <span class="va">model_time</span> <span class="op">*</span> <span class="va">cycle_years</span>,</span>
<span>      <span class="co"># Derive costs other than drug acquisition, as at time zero</span></span>
<span>      cost_nondaq <span class="op">=</span> <span class="va">cost_total</span> <span class="op">-</span> <span class="va">cost_daq_new</span> <span class="op">-</span> <span class="va">cost_daq_soc</span>,</span>
<span>      <span class="co"># ... and at the start of each timestep</span></span>
<span>      cost_nondaq_rup <span class="op">=</span> <span class="va">cost_total_rup</span> <span class="op">-</span> <span class="va">cost_daq_new_rup</span> <span class="op">-</span> <span class="va">cost_daq_soc_rup</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="co"># Create and view dataset for SoC</span></span>
<span><span class="va">hemout_soc</span> <span class="op">&lt;-</span> <span class="va">payoffs</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">int</span><span class="op">==</span><span class="st">"soc"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">hemout_soc</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 16</span></span></span>
<span><span class="co">#&gt;   model_time cost_daq_new cost_daq_soc cost_total   qaly life_year int      vt</span></span>
<span><span class="co">#&gt;        <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>          1            0         396.       695. 0.015<span style="text-decoration: underline;">3</span>    0.019<span style="text-decoration: underline;">2</span> soc   1    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>          2            0         388.       705. 0.015<span style="text-decoration: underline;">2</span>    0.019<span style="text-decoration: underline;">1</span> soc   0.999</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>          3            0         380.       714. 0.015<span style="text-decoration: underline;">1</span>    0.019<span style="text-decoration: underline;">1</span> soc   0.999</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>          4            0         372.       721. 0.015<span style="text-decoration: underline;">0</span>    0.019<span style="text-decoration: underline;">1</span> soc   0.998</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>          5            0         365.       726. 0.014<span style="text-decoration: underline;">9</span>    0.019<span style="text-decoration: underline;">0</span> soc   0.998</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>          6            0         357.       730. 0.014<span style="text-decoration: underline;">8</span>    0.018<span style="text-decoration: underline;">9</span> soc   0.997</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 8 more variables: cost_daq_new_rup &lt;dbl&gt;, cost_daq_soc_rup &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   cost_total_rup &lt;dbl&gt;, qaly_rup &lt;dbl&gt;, life_year_rup &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   model_years &lt;dbl&gt;, cost_nondaq &lt;dbl&gt;, cost_nondaq_rup &lt;dbl&gt;</span></span></span>
<span></span>
<span><span class="co"># Create and view dataset for new intervention</span></span>
<span><span class="va">hemout_new</span> <span class="op">&lt;-</span> <span class="va">payoffs</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">int</span><span class="op">==</span><span class="st">"new"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">hemout_new</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 16</span></span></span>
<span><span class="co">#&gt;   model_time cost_daq_new cost_daq_soc cost_total   qaly life_year int      vt</span></span>
<span><span class="co">#&gt;        <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>          1        <span style="text-decoration: underline;">1</span>493.            0      <span style="text-decoration: underline;">1</span>847. 0.015<span style="text-decoration: underline;">3</span>    0.019<span style="text-decoration: underline;">2</span> new   1    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>          2        <span style="text-decoration: underline;">1</span>477.            0      <span style="text-decoration: underline;">1</span>831. 0.015<span style="text-decoration: underline;">3</span>    0.019<span style="text-decoration: underline;">2</span> new   0.999</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>          3        <span style="text-decoration: underline;">1</span>461.            0      <span style="text-decoration: underline;">1</span>815. 0.015<span style="text-decoration: underline;">2</span>    0.019<span style="text-decoration: underline;">1</span> new   0.999</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>          4        <span style="text-decoration: underline;">1</span>446.            0      <span style="text-decoration: underline;">1</span>799. 0.015<span style="text-decoration: underline;">2</span>    0.019<span style="text-decoration: underline;">1</span> new   0.998</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>          5        <span style="text-decoration: underline;">1</span>431.            0      <span style="text-decoration: underline;">1</span>783. 0.015<span style="text-decoration: underline;">1</span>    0.019<span style="text-decoration: underline;">0</span> new   0.998</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>          6        <span style="text-decoration: underline;">1</span>416.            0      <span style="text-decoration: underline;">1</span>766. 0.015<span style="text-decoration: underline;">0</span>    0.019<span style="text-decoration: underline;">0</span> new   0.997</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 8 more variables: cost_daq_new_rup &lt;dbl&gt;, cost_daq_soc_rup &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   cost_total_rup &lt;dbl&gt;, qaly_rup &lt;dbl&gt;, life_year_rup &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   model_years &lt;dbl&gt;, cost_nondaq &lt;dbl&gt;, cost_nondaq_rup &lt;dbl&gt;</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="scenario-1-no-dynamic-uptake-or-pricing">Scenario 1: No dynamic uptake or pricing<a class="anchor" aria-label="anchor" href="#scenario-1-no-dynamic-uptake-or-pricing"></a>
</h3>
<p>With non-dynamic uptake, we use
<code>uptakes</code>=<code>uptake_single</code>=1. Drug acquisition
costs are constant in real terms (<code>prices=prices_static</code>) and
are discounted at the risk-free real rate
(<code>discrate=disc_cycle</code>). Other costs rise in line with
general price inflation (<code>prices=prices_oth</code>) and are
discounted at nominal discount rates
(<code>discrate=nomdisc_cycle</code>). QALYs are not affected by price
inflation (<code>prices=prices_static</code>) and are discounted at the
risk-free real rate (<code>discrate=disc_cycle</code>).</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># SOC, costs other than drug acquisition</span></span>
<span><span class="va">s1_soc_othcost</span> <span class="op">&lt;-</span> <span class="fu">dynamicpv</span><span class="fu">::</span><span class="fu"><a href="../reference/dynpv.html">dynpv</a></span><span class="op">(</span></span>
<span>    uptakes <span class="op">=</span> <span class="va">uptake_single</span>,</span>
<span>    payoffs <span class="op">=</span> <span class="va">hemout_soc</span><span class="op">$</span><span class="va">cost_nondaq_rup</span>,</span>
<span>    prices <span class="op">=</span> <span class="va">prices_oth</span>,</span>
<span>    discrate <span class="op">=</span> <span class="va">nomdisc_cycle</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="co"># SOC, drug acquisition costs</span></span>
<span><span class="va">s1_soc_daqcost</span> <span class="op">&lt;-</span> <span class="fu">dynamicpv</span><span class="fu">::</span><span class="fu"><a href="../reference/dynpv.html">dynpv</a></span><span class="op">(</span></span>
<span>    uptakes <span class="op">=</span> <span class="va">uptake_single</span>,</span>
<span>    payoffs <span class="op">=</span> <span class="va">hemout_soc</span><span class="op">$</span><span class="va">cost_daq_soc_rup</span>,</span>
<span>    prices <span class="op">=</span> <span class="va">prices_static</span>,</span>
<span>    discrate <span class="op">=</span> <span class="va">disc_cycle</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="co"># SOC, total costs</span></span>
<span><span class="va">s1_soc_cost</span> <span class="op">&lt;-</span> <span class="va">s1_soc_daqcost</span> <span class="op">+</span> <span class="va">s1_soc_othcost</span></span>
<span></span>
<span><span class="co"># SOC, QALYs</span></span>
<span><span class="va">s1_soc_qaly</span> <span class="op">&lt;-</span> <span class="fu">dynamicpv</span><span class="fu">::</span><span class="fu"><a href="../reference/dynpv.html">dynpv</a></span><span class="op">(</span></span>
<span>    uptakes <span class="op">=</span> <span class="va">uptake_single</span>,</span>
<span>    payoffs <span class="op">=</span> <span class="va">hemout_soc</span><span class="op">$</span><span class="va">qaly_rup</span>,</span>
<span>    prices <span class="op">=</span> <span class="va">prices_static</span>,</span>
<span>    discrate <span class="op">=</span> <span class="va">disc_cycle</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="co"># New intervention, costs other than drug acquisition</span></span>
<span><span class="va">s1_new_othcost</span> <span class="op">&lt;-</span> <span class="fu">dynamicpv</span><span class="fu">::</span><span class="fu"><a href="../reference/dynpv.html">dynpv</a></span><span class="op">(</span></span>
<span>    uptakes <span class="op">=</span> <span class="va">uptake_single</span>,</span>
<span>    payoffs <span class="op">=</span> <span class="va">hemout_new</span><span class="op">$</span><span class="va">cost_nondaq_rup</span>,</span>
<span>    prices <span class="op">=</span> <span class="va">prices_oth</span>,</span>
<span>    discrate <span class="op">=</span> <span class="va">nomdisc_cycle</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="co"># New intervention, drug acquisition costs</span></span>
<span><span class="va">s1_new_daqcost</span> <span class="op">&lt;-</span> <span class="fu">dynamicpv</span><span class="fu">::</span><span class="fu"><a href="../reference/dynpv.html">dynpv</a></span><span class="op">(</span></span>
<span>    uptakes <span class="op">=</span> <span class="va">uptake_single</span>,</span>
<span>    payoffs <span class="op">=</span> <span class="va">hemout_new</span><span class="op">$</span><span class="va">cost_daq_new_rup</span>,</span>
<span>    prices <span class="op">=</span> <span class="va">prices_static</span>,</span>
<span>    discrate <span class="op">=</span> <span class="va">disc_cycle</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="co"># New intervention, total costs</span></span>
<span><span class="va">s1_new_cost</span> <span class="op">&lt;-</span> <span class="va">s1_new_daqcost</span> <span class="op">+</span> <span class="va">s1_new_othcost</span></span>
<span></span>
<span><span class="co"># New intervention, QALYs</span></span>
<span><span class="va">s1_new_qaly</span> <span class="op">&lt;-</span> <span class="fu">dynamicpv</span><span class="fu">::</span><span class="fu"><a href="../reference/dynpv.html">dynpv</a></span><span class="op">(</span></span>
<span>    uptakes <span class="op">=</span> <span class="va">uptake_single</span>,</span>
<span>    payoffs <span class="op">=</span> <span class="va">hemout_new</span><span class="op">$</span><span class="va">qaly_rup</span>,</span>
<span>    prices <span class="op">=</span> <span class="va">prices_static</span>,</span>
<span>    discrate <span class="op">=</span> <span class="va">disc_cycle</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="co"># Incremental cost</span></span>
<span><span class="va">s1_icost</span> <span class="op">&lt;-</span> <span class="va">s1_new_cost</span> <span class="op">-</span> <span class="va">s1_soc_cost</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">s1_icost</span><span class="op">)</span></span>
<span><span class="co">#&gt; Summary of Dynamic Pricing and Uptake</span></span>
<span><span class="co">#&gt;      Number of cohorts:             1044 </span></span>
<span><span class="co">#&gt;      Number of times:               1 </span></span>
<span><span class="co">#&gt;      Total uptake:                  0 </span></span>
<span><span class="co">#&gt;      Total present value:           117033.5 </span></span>
<span><span class="co">#&gt;      Mean present value:            Inf</span></span>
<span></span>
<span><span class="co"># Incremental QALY</span></span>
<span><span class="va">s1_iqaly</span> <span class="op">&lt;-</span> <span class="va">s1_new_qaly</span> <span class="op">-</span> <span class="va">s1_soc_qaly</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">s1_iqaly</span><span class="op">)</span></span>
<span><span class="co">#&gt; Summary of Dynamic Pricing and Uptake</span></span>
<span><span class="co">#&gt;      Number of cohorts:             1044 </span></span>
<span><span class="co">#&gt;      Number of times:               1 </span></span>
<span><span class="co">#&gt;      Total uptake:                  0 </span></span>
<span><span class="co">#&gt;      Total present value:           0.9255249 </span></span>
<span><span class="co">#&gt;      Mean present value:            Inf</span></span>
<span></span>
<span><span class="co"># ICER</span></span>
<span><span class="va">s1_icer</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/total.html">total</a></span><span class="op">(</span><span class="va">s1_icost</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="../reference/total.html">total</a></span><span class="op">(</span><span class="va">s1_iqaly</span><span class="op">)</span></span>
<span><span class="va">s1_icer</span></span>
<span><span class="co">#&gt; [1] 126451</span></span></code></pre></div>
<p>These results show that the new intervention is associated with
$117,034 incremental costs relative to the standard of care (including
$141,997 of drug acquisition costs for the new intervention) and 0.926
incremental QALYs. The cumulative ICER (incremental cost per QALY) is
$126,451 per QALY at the 20 year time horizon.</p>
</div>
<div class="section level3">
<h3 id="scenario-2-dynamic-pricing-no-dynamic-uptake">Scenario 2: Dynamic pricing, no dynamic uptake<a class="anchor" aria-label="anchor" href="#scenario-2-dynamic-pricing-no-dynamic-uptake"></a>
</h3>
<p>The costs of drug acquisition in each arm differ in Scenario 2
through applying the relevant dynamic price index
(<code>prices_dyn_soc</code> and <code>prices_dyn_new</code>), with
discounting at nominal rates (<code>discrate = nomdisc_cycle</code>).
Otherwise costs and QALYs are unchanged from Scenario 1.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># SOC, costs other than drug acquisition are unchanged</span></span>
<span><span class="va">s2_soc_othcost</span> <span class="op">&lt;-</span> <span class="va">s1_soc_othcost</span></span>
<span></span>
<span><span class="co"># SoC, drug acquisition costs</span></span>
<span><span class="va">s2_soc_daqcost</span> <span class="op">&lt;-</span> <span class="fu">dynamicpv</span><span class="fu">::</span><span class="fu"><a href="../reference/dynpv.html">dynpv</a></span><span class="op">(</span></span>
<span>    uptakes <span class="op">=</span> <span class="va">uptake_single</span>,</span>
<span>    payoffs <span class="op">=</span> <span class="va">hemout_soc</span><span class="op">$</span><span class="va">cost_daq_soc_rup</span>,</span>
<span>    prices <span class="op">=</span> <span class="va">prices_dyn_soc</span>,</span>
<span>    discrate <span class="op">=</span> <span class="va">nomdisc_cycle</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="co"># SoC, total costs</span></span>
<span><span class="va">s2_soc_cost</span> <span class="op">&lt;-</span> <span class="va">s2_soc_daqcost</span> <span class="op">+</span> <span class="va">s2_soc_othcost</span></span>
<span></span>
<span><span class="co"># SoC, QALYs are unchanged</span></span>
<span><span class="va">s2_soc_qaly</span> <span class="op">&lt;-</span> <span class="va">s1_soc_qaly</span></span>
<span></span>
<span><span class="co"># New intervention, costs other than drug acquisition are unchanged</span></span>
<span><span class="va">s2_new_othcost</span> <span class="op">&lt;-</span> <span class="va">s1_new_othcost</span></span>
<span></span>
<span><span class="co"># New intervention, drug acquisition costs</span></span>
<span><span class="va">s2_new_daqcost</span> <span class="op">&lt;-</span> <span class="fu">dynamicpv</span><span class="fu">::</span><span class="fu"><a href="../reference/dynpv.html">dynpv</a></span><span class="op">(</span></span>
<span>    uptakes <span class="op">=</span> <span class="va">uptake_single</span>,</span>
<span>    payoffs <span class="op">=</span> <span class="va">hemout_new</span><span class="op">$</span><span class="va">cost_daq_new_rup</span>,</span>
<span>    prices <span class="op">=</span> <span class="va">prices_dyn_new</span>,</span>
<span>    discrate <span class="op">=</span> <span class="va">nomdisc_cycle</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="co"># New intervention, total costs</span></span>
<span><span class="va">s2_new_cost</span> <span class="op">&lt;-</span> <span class="va">s2_new_daqcost</span> <span class="op">+</span> <span class="va">s2_new_othcost</span></span>
<span></span>
<span><span class="co"># New intervention, QALYs are unchanged</span></span>
<span><span class="va">s2_new_qaly</span> <span class="op">&lt;-</span> <span class="va">s1_new_qaly</span></span>
<span></span>
<span><span class="co"># Incremental cost</span></span>
<span><span class="va">s2_icost</span> <span class="op">&lt;-</span> <span class="va">s2_new_cost</span> <span class="op">-</span> <span class="va">s2_soc_cost</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">s2_icost</span><span class="op">)</span></span>
<span><span class="co">#&gt; Summary of Dynamic Pricing and Uptake</span></span>
<span><span class="co">#&gt;      Number of cohorts:             1044 </span></span>
<span><span class="co">#&gt;      Number of times:               1 </span></span>
<span><span class="co">#&gt;      Total uptake:                  0 </span></span>
<span><span class="co">#&gt;      Total present value:           114820 </span></span>
<span><span class="co">#&gt;      Mean present value:            Inf</span></span>
<span></span>
<span><span class="co"># Incremental QALY</span></span>
<span><span class="va">s2_iqaly</span> <span class="op">&lt;-</span> <span class="va">s2_new_qaly</span> <span class="op">-</span> <span class="va">s2_soc_qaly</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">s2_iqaly</span><span class="op">)</span></span>
<span><span class="co">#&gt; Summary of Dynamic Pricing and Uptake</span></span>
<span><span class="co">#&gt;      Number of cohorts:             1044 </span></span>
<span><span class="co">#&gt;      Number of times:               1 </span></span>
<span><span class="co">#&gt;      Total uptake:                  0 </span></span>
<span><span class="co">#&gt;      Total present value:           0.9255249 </span></span>
<span><span class="co">#&gt;      Mean present value:            Inf</span></span>
<span></span>
<span><span class="co"># ICER</span></span>
<span><span class="va">s2_icer</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/total.html">total</a></span><span class="op">(</span><span class="va">s2_icost</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="../reference/total.html">total</a></span><span class="op">(</span><span class="va">s2_iqaly</span><span class="op">)</span></span>
<span><span class="va">s2_icer</span></span>
<span><span class="co">#&gt; [1] 124059.3</span></span></code></pre></div>
<p>Under scenario 2, the new intervention has an incremental
cost-effectiveness of $124,059 per QALY (incremental costs of $114,820,
incremental QALYs of 0.926).</p>
</div>
<div class="section level3">
<h3 id="scenario-3-dynamic-uptake-not-dynamic-pricing">Scenario 3: Dynamic uptake, not dynamic pricing<a class="anchor" aria-label="anchor" href="#scenario-3-dynamic-uptake-not-dynamic-pricing"></a>
</h3>
<p>The calculation for Scenario 3 is the same as for Scenario 1 except
for dynamic uptake, which is handled by setting
<code>uptakes = uptake_multi</code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># SOC, costs other than drug acquisition</span></span>
<span><span class="va">s3_soc_othcost</span> <span class="op">&lt;-</span> <span class="fu">dynamicpv</span><span class="fu">::</span><span class="fu"><a href="../reference/dynpv.html">dynpv</a></span><span class="op">(</span></span>
<span>    uptakes <span class="op">=</span> <span class="va">uptake_multi</span>,</span>
<span>    payoffs <span class="op">=</span> <span class="va">hemout_soc</span><span class="op">$</span><span class="va">cost_nondaq_rup</span>,</span>
<span>    prices <span class="op">=</span> <span class="va">prices_oth</span>,</span>
<span>    discrate <span class="op">=</span> <span class="va">nomdisc_cycle</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="co"># SoC, drug acquisition costs</span></span>
<span><span class="va">s3_soc_daqcost</span> <span class="op">&lt;-</span> <span class="fu">dynamicpv</span><span class="fu">::</span><span class="fu"><a href="../reference/dynpv.html">dynpv</a></span><span class="op">(</span></span>
<span>    uptakes <span class="op">=</span> <span class="va">uptake_multi</span>,</span>
<span>    payoffs <span class="op">=</span> <span class="va">hemout_soc</span><span class="op">$</span><span class="va">cost_daq_soc_rup</span>,</span>
<span>    prices <span class="op">=</span> <span class="va">prices_static</span>,</span>
<span>    discrate <span class="op">=</span> <span class="va">disc_cycle</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="co"># SoC, total costs</span></span>
<span><span class="va">s3_soc_cost</span> <span class="op">&lt;-</span> <span class="va">s3_soc_daqcost</span> <span class="op">+</span> <span class="va">s3_soc_othcost</span></span>
<span></span>
<span><span class="co"># SoC, QALYs</span></span>
<span><span class="va">s3_soc_qaly</span> <span class="op">&lt;-</span> <span class="fu">dynamicpv</span><span class="fu">::</span><span class="fu"><a href="../reference/dynpv.html">dynpv</a></span><span class="op">(</span></span>
<span>    uptakes <span class="op">=</span> <span class="va">uptake_multi</span>,</span>
<span>    payoffs <span class="op">=</span> <span class="va">hemout_soc</span><span class="op">$</span><span class="va">qaly_rup</span>,</span>
<span>    prices <span class="op">=</span> <span class="va">prices_static</span>,</span>
<span>    discrate <span class="op">=</span> <span class="va">disc_cycle</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="co"># New intervention, costs other than drug acquisition</span></span>
<span><span class="va">s3_new_othcost</span> <span class="op">&lt;-</span> <span class="fu">dynamicpv</span><span class="fu">::</span><span class="fu"><a href="../reference/dynpv.html">dynpv</a></span><span class="op">(</span></span>
<span>    uptakes <span class="op">=</span> <span class="va">uptake_multi</span>,</span>
<span>    payoffs <span class="op">=</span> <span class="va">hemout_new</span><span class="op">$</span><span class="va">cost_nondaq_rup</span>,</span>
<span>    prices <span class="op">=</span> <span class="va">prices_oth</span>,</span>
<span>    discrate <span class="op">=</span> <span class="va">nomdisc_cycle</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="co"># New intervention, drug acquisition costs</span></span>
<span><span class="va">s3_new_daqcost</span> <span class="op">&lt;-</span> <span class="fu">dynamicpv</span><span class="fu">::</span><span class="fu"><a href="../reference/dynpv.html">dynpv</a></span><span class="op">(</span></span>
<span>    uptakes <span class="op">=</span> <span class="va">uptake_multi</span>,</span>
<span>    payoffs <span class="op">=</span> <span class="va">hemout_new</span><span class="op">$</span><span class="va">cost_daq_new_rup</span>,</span>
<span>    prices <span class="op">=</span> <span class="va">prices_static</span>,</span>
<span>    discrate <span class="op">=</span> <span class="va">disc_cycle</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="co"># New intervention, total costs</span></span>
<span><span class="va">s3_new_cost</span> <span class="op">&lt;-</span> <span class="va">s3_new_daqcost</span> <span class="op">+</span> <span class="va">s3_new_othcost</span></span>
<span></span>
<span><span class="co"># New intervention, QALYs</span></span>
<span><span class="va">s3_new_qaly</span> <span class="op">&lt;-</span> <span class="fu">dynamicpv</span><span class="fu">::</span><span class="fu"><a href="../reference/dynpv.html">dynpv</a></span><span class="op">(</span></span>
<span>    uptakes <span class="op">=</span> <span class="va">uptake_multi</span>,</span>
<span>    payoffs <span class="op">=</span> <span class="va">hemout_new</span><span class="op">$</span><span class="va">qaly_rup</span>,</span>
<span>    prices <span class="op">=</span> <span class="va">prices_static</span>,</span>
<span>    discrate <span class="op">=</span> <span class="va">disc_cycle</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="co"># Incremental costs</span></span>
<span><span class="va">s3_icost</span> <span class="op">&lt;-</span> <span class="va">s3_new_cost</span> <span class="op">-</span> <span class="va">s3_soc_cost</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">s3_icost</span><span class="op">)</span></span>
<span><span class="co">#&gt; Summary of Dynamic Pricing and Uptake</span></span>
<span><span class="co">#&gt;      Number of cohorts:             1044 </span></span>
<span><span class="co">#&gt;      Number of times:               1 </span></span>
<span><span class="co">#&gt;      Total uptake:                  0 </span></span>
<span><span class="co">#&gt;      Total present value:           78010854 </span></span>
<span><span class="co">#&gt;      Mean present value:            Inf</span></span>
<span></span>
<span><span class="co"># Incremental QALYs</span></span>
<span><span class="va">s3_iqaly</span> <span class="op">&lt;-</span> <span class="va">s3_new_qaly</span> <span class="op">-</span> <span class="va">s3_soc_qaly</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">s3_iqaly</span><span class="op">)</span></span>
<span><span class="co">#&gt; Summary of Dynamic Pricing and Uptake</span></span>
<span><span class="co">#&gt;      Number of cohorts:             1044 </span></span>
<span><span class="co">#&gt;      Number of times:               1 </span></span>
<span><span class="co">#&gt;      Total uptake:                  0 </span></span>
<span><span class="co">#&gt;      Total present value:           520.8296 </span></span>
<span><span class="co">#&gt;      Mean present value:            Inf</span></span>
<span></span>
<span><span class="co"># ICER</span></span>
<span><span class="va">s3_icer</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/total.html">total</a></span><span class="op">(</span><span class="va">s3_icost</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="../reference/total.html">total</a></span><span class="op">(</span><span class="va">s3_iqaly</span><span class="op">)</span></span>
<span><span class="va">s3_icer</span></span>
<span><span class="co">#&gt; [1] 149781.9</span></span></code></pre></div>
<p>Under scenario 3, the new intervention has an incremental
cost-effectiveness of $149,782 per QALY (incremental costs of
$78,010,854, incremental QALYs of 521 from a cohort comprising 992
patients).</p>
</div>
<div class="section level3">
<h3 id="scenario-4-dynamic-pricing-and-uptake">Scenario 4: Dynamic pricing and uptake<a class="anchor" aria-label="anchor" href="#scenario-4-dynamic-pricing-and-uptake"></a>
</h3>
<p>The costs of drug acquisition in each arm differ in Scenario 4 from
Scenario 3 through applying the relevant dynamic price index
(<code>prices_dyn_soc</code> and <code>prices_dyn_new</code>). Otherwise
costs and QALYs are unchanged from Scenario 3.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># SOC, costs other than drug acquisition are unchanged</span></span>
<span><span class="va">s4_soc_othcost</span> <span class="op">&lt;-</span> <span class="va">s3_soc_othcost</span></span>
<span></span>
<span><span class="co"># SoC, drug acquisition costs</span></span>
<span><span class="va">s4_soc_daqcost</span> <span class="op">&lt;-</span> <span class="fu">dynamicpv</span><span class="fu">::</span><span class="fu"><a href="../reference/dynpv.html">dynpv</a></span><span class="op">(</span></span>
<span>    uptakes <span class="op">=</span> <span class="va">uptake_multi</span>,</span>
<span>    payoffs <span class="op">=</span> <span class="va">hemout_soc</span><span class="op">$</span><span class="va">cost_daq_soc_rup</span>,</span>
<span>    prices <span class="op">=</span> <span class="va">prices_dyn_soc</span>,</span>
<span>    discrate <span class="op">=</span> <span class="va">nomdisc_cycle</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="co"># SoC, total costs</span></span>
<span><span class="va">s4_soc_cost</span> <span class="op">&lt;-</span> <span class="va">s4_soc_daqcost</span> <span class="op">+</span> <span class="va">s4_soc_othcost</span></span>
<span></span>
<span><span class="co"># SoC, QALYs are unchanged</span></span>
<span><span class="va">s4_soc_qaly</span> <span class="op">&lt;-</span> <span class="va">s3_soc_qaly</span></span>
<span></span>
<span><span class="co"># New intervention, costs other than drug acquisition are unchanged</span></span>
<span><span class="va">s4_new_othcost</span> <span class="op">&lt;-</span> <span class="va">s3_new_othcost</span></span>
<span></span>
<span><span class="co"># New intervention, drug acquisition costs</span></span>
<span><span class="va">s4_new_daqcost</span> <span class="op">&lt;-</span> <span class="fu">dynamicpv</span><span class="fu">::</span><span class="fu"><a href="../reference/dynpv.html">dynpv</a></span><span class="op">(</span></span>
<span>    uptakes <span class="op">=</span> <span class="va">uptake_multi</span>,</span>
<span>    payoffs <span class="op">=</span> <span class="va">hemout_new</span><span class="op">$</span><span class="va">cost_daq_new_rup</span>,</span>
<span>    prices <span class="op">=</span> <span class="va">prices_dyn_new</span>,</span>
<span>    discrate <span class="op">=</span> <span class="va">nomdisc_cycle</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="co"># New intervention, total costs</span></span>
<span><span class="va">s4_new_cost</span> <span class="op">&lt;-</span> <span class="va">s4_new_daqcost</span> <span class="op">+</span> <span class="va">s4_new_othcost</span></span>
<span></span>
<span><span class="co"># New intervention, QALYs</span></span>
<span><span class="va">s4_new_qaly</span> <span class="op">&lt;-</span> <span class="va">s3_new_qaly</span></span>
<span></span>
<span><span class="co"># Incremental costs</span></span>
<span><span class="va">s4_icost</span> <span class="op">&lt;-</span> <span class="va">s4_new_cost</span> <span class="op">-</span> <span class="va">s4_soc_cost</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">s4_icost</span><span class="op">)</span></span>
<span><span class="co">#&gt; Summary of Dynamic Pricing and Uptake</span></span>
<span><span class="co">#&gt;      Number of cohorts:             1044 </span></span>
<span><span class="co">#&gt;      Number of times:               1 </span></span>
<span><span class="co">#&gt;      Total uptake:                  0 </span></span>
<span><span class="co">#&gt;      Total present value:           49255066 </span></span>
<span><span class="co">#&gt;      Mean present value:            Inf</span></span>
<span></span>
<span><span class="co"># Incremental QALYs</span></span>
<span><span class="va">s4_iqaly</span> <span class="op">&lt;-</span> <span class="va">s4_new_qaly</span> <span class="op">-</span> <span class="va">s4_soc_qaly</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">s4_iqaly</span><span class="op">)</span></span>
<span><span class="co">#&gt; Summary of Dynamic Pricing and Uptake</span></span>
<span><span class="co">#&gt;      Number of cohorts:             1044 </span></span>
<span><span class="co">#&gt;      Number of times:               1 </span></span>
<span><span class="co">#&gt;      Total uptake:                  0 </span></span>
<span><span class="co">#&gt;      Total present value:           520.8296 </span></span>
<span><span class="co">#&gt;      Mean present value:            Inf</span></span>
<span></span>
<span><span class="co"># ICER</span></span>
<span><span class="va">s4_icer</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/total.html">total</a></span><span class="op">(</span><span class="va">s4_icost</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="../reference/total.html">total</a></span><span class="op">(</span><span class="va">s4_iqaly</span><span class="op">)</span></span>
<span><span class="va">s4_icer</span></span>
<span><span class="co">#&gt; [1] 94570.4</span></span></code></pre></div>
<p>Under scenario 4, the new intervention has an incremental
cost-effectiveness of $94,570 per QALY (incremental costs of
$49,255,066, incremental QALYs of 521 from a cohort comprising 992
patients).</p>
</div>
<div class="section level3">
<h3 id="summary-of-results">Summary of results<a class="anchor" aria-label="anchor" href="#summary-of-results"></a>
</h3>
<p>Total costs and QALYs for each scenario are summarized in the table
below. The results above are skewed by the fact that some scenarios
represent more than one patient cohort. Presenting results per patient,
allows easier comparison between the scenarios.</p>
<table class="table">
<caption>Cost-effectiveness model results by scenario</caption>
<thead><tr class="header">
<th align="left"></th>
<th align="left"></th>
<th>Scenario 1</th>
<th>Scenario 2</th>
<th>Scenario 3</th>
<th>Scenario 4</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Dynamic pricing?</td>
<td align="left"></td>
<td>No</td>
<td>Yes</td>
<td>No</td>
<td>Yes</td>
</tr>
<tr class="even">
<td align="left">Dynamic uptake?</td>
<td align="left"></td>
<td>No</td>
<td>No</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr class="odd">
<td align="left">Cohort size</td>
<td align="left"></td>
<td>1</td>
<td>1</td>
<td>992</td>
<td>992</td>
</tr>
<tr class="even">
<td align="left">Total costs (cohort)</td>
<td align="left"></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">New intervention</td>
<td>194,157</td>
<td>191,248</td>
<td>129,401,743</td>
<td>91,698,157</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">Standard of care</td>
<td>77,123</td>
<td>76,428</td>
<td>51,390,888</td>
<td>42,443,090</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">Incremental</td>
<td>117,034</td>
<td>114,820</td>
<td>78,010,854</td>
<td>49,255,066</td>
</tr>
<tr class="even">
<td align="left">Total costs (per patient)</td>
<td align="left"></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">New intervention</td>
<td>194,157</td>
<td>191,248</td>
<td>130,380</td>
<td>92,391</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">Standard of care</td>
<td>77,123</td>
<td>76,428</td>
<td>51,779</td>
<td>42,764</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">Incremental</td>
<td>117,034</td>
<td>114,820</td>
<td>78,600</td>
<td>49,627</td>
</tr>
<tr class="even">
<td align="left">Total QALYs (cohort)</td>
<td align="left"></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">New intervention</td>
<td>2.08</td>
<td>2.08</td>
<td>1,309</td>
<td>1,309</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">Standard of care</td>
<td>1.154</td>
<td>1.154</td>
<td>788</td>
<td>788</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">Incremental</td>
<td>0.926</td>
<td>0.926</td>
<td>521</td>
<td>521</td>
</tr>
<tr class="even">
<td align="left">Total QALYs (per patient)</td>
<td align="left"></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">New intervention</td>
<td>2.08</td>
<td>2.08</td>
<td>1.319</td>
<td>1.319</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">Standard of care</td>
<td>1.154</td>
<td>1.154</td>
<td>0.794</td>
<td>0.794</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">Incremental</td>
<td>0.926</td>
<td>0.926</td>
<td>0.525</td>
<td>0.525</td>
</tr>
<tr class="even">
<td align="left">ICER</td>
<td align="left"></td>
<td>126,451</td>
<td>124,059</td>
<td>149,782</td>
<td>94,570</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="future-single-cohort-icer">Future single cohort ICER<a class="anchor" aria-label="anchor" href="#future-single-cohort-icer"></a>
</h2>
<p>The table above presents the cost-effectiveness results as of the
date of calculation, 2025-09-01. However, it is interesting to explore
how the ICER will change over time, given the expected evolution of
prices. We use <code><a href="../reference/futurepv.html">dynamicpv::futurepv()</a></code> to calculate present
values at future times. This function is a wrapper for
<code><a href="../reference/dynpv.html">dynamicpv::dynpv()</a></code>. This is the single cohort ICER (no
dynamic uptake) but with dynamic pricing, so corresponds with Scenario 2
from earlier.</p>
<p>First, we calculate the costs at each time of interest. Then we
calculate the ICER, given the incremental QALYs we have already observed
- and which are immune from pricing effects.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Times at which to plot ICER</span></span>
<span><span class="va">gtimes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">thoz</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="va">cycle_years</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="co"># SOC drug acquisition costs</span></span>
<span><span class="va">gc_soc_daq</span> <span class="op">&lt;-</span> <span class="va">gtimes</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_vec</a></span><span class="op">(</span>\<span class="op">(</span><span class="va">l</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="../reference/futurepv.html">futurepv</a></span><span class="op">(</span></span>
<span>        tzero <span class="op">=</span> <span class="va">l</span>,</span>
<span>        payoffs <span class="op">=</span> <span class="va">hemout_soc</span><span class="op">$</span><span class="va">cost_daq_soc_rup</span>,</span>
<span>        prices <span class="op">=</span> <span class="va">prices_dyn_soc</span>,</span>
<span>        discrate <span class="op">=</span> <span class="va">nomdisc_cycle</span></span>
<span>    <span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># SOC other costs</span></span>
<span><span class="va">gc_soc_oth</span> <span class="op">&lt;-</span> <span class="va">gtimes</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_vec</a></span><span class="op">(</span>\<span class="op">(</span><span class="va">l</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="../reference/futurepv.html">futurepv</a></span><span class="op">(</span></span>
<span>        tzero <span class="op">=</span> <span class="va">l</span>,</span>
<span>        payoffs <span class="op">=</span> <span class="va">hemout_soc</span><span class="op">$</span><span class="va">cost_nondaq_rup</span>,</span>
<span>        prices <span class="op">=</span> <span class="va">prices_oth</span>,</span>
<span>        discrate <span class="op">=</span> <span class="va">nomdisc_cycle</span></span>
<span>    <span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># New drug acquisition costs</span></span>
<span><span class="va">gc_new_daq</span> <span class="op">&lt;-</span> <span class="va">gtimes</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_vec</a></span><span class="op">(</span>\<span class="op">(</span><span class="va">l</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="../reference/futurepv.html">futurepv</a></span><span class="op">(</span></span>
<span>        tzero <span class="op">=</span> <span class="va">l</span>,</span>
<span>        payoffs <span class="op">=</span> <span class="va">hemout_new</span><span class="op">$</span><span class="va">cost_daq_new_rup</span>,</span>
<span>        prices <span class="op">=</span> <span class="va">prices_dyn_new</span>,</span>
<span>        discrate <span class="op">=</span> <span class="va">nomdisc_cycle</span></span>
<span>    <span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># New other costs</span></span>
<span><span class="va">gc_new_oth</span> <span class="op">&lt;-</span> <span class="va">gtimes</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_vec</a></span><span class="op">(</span>\<span class="op">(</span><span class="va">l</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="../reference/futurepv.html">futurepv</a></span><span class="op">(</span></span>
<span>        tzero <span class="op">=</span> <span class="va">l</span>,</span>
<span>        payoffs <span class="op">=</span> <span class="va">hemout_new</span><span class="op">$</span><span class="va">cost_nondaq_rup</span>,</span>
<span>        prices <span class="op">=</span> <span class="va">prices_oth</span>,</span>
<span>        discrate <span class="op">=</span> <span class="va">nomdisc_cycle</span></span>
<span>    <span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># Combine in a tibble</span></span>
<span><span class="va">ds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>    <span class="co"># Time in weeks and years</span></span>
<span>    time_weeks <span class="op">=</span> <span class="va">gtimes</span>,</span>
<span>    time_years <span class="op">=</span> <span class="va">time_weeks</span> <span class="op">*</span> <span class="va">cycle_years</span>,</span>
<span>    <span class="co"># Evaluation date</span></span>
<span>    evaldate <span class="op">=</span> <span class="va">doc</span> <span class="op">+</span> <span class="va">time_weeks</span> <span class="op">*</span> <span class="fl">7</span>,</span>
<span>    <span class="co"># Price/inflation index</span></span>
<span>    pinfl <span class="op">=</span> <span class="va">prices_oth</span><span class="op">[</span><span class="va">gtimes</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span>,</span>
<span>    <span class="co"># Total costs for each intervention</span></span>
<span>    totcost_new <span class="op">=</span> <span class="va">gc_new_daq</span> <span class="op">+</span> <span class="va">gc_new_oth</span>,</span>
<span>    totcost_soc <span class="op">=</span> <span class="va">gc_soc_daq</span> <span class="op">+</span> <span class="va">gc_soc_oth</span>,</span>
<span>    <span class="co"># Scenario 1/2 QALYs</span></span>
<span>    qaly_soc <span class="op">=</span> <span class="fu"><a href="../reference/total.html">total</a></span><span class="op">(</span><span class="va">s1_soc_qaly</span><span class="op">)</span>,</span>
<span>    qaly_new <span class="op">=</span> <span class="fu"><a href="../reference/total.html">total</a></span><span class="op">(</span><span class="va">s1_new_qaly</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    <span class="co"># Incremental cost and QALYs</span></span>
<span>    icost <span class="op">=</span> <span class="va">totcost_new</span><span class="op">-</span><span class="va">totcost_soc</span>,</span>
<span>    iqaly <span class="op">=</span> <span class="va">qaly_new</span><span class="op">-</span><span class="va">qaly_soc</span>,</span>
<span>    <span class="co"># Nominal ICER, and real (inflation adjusted) ICER</span></span>
<span>    Nominal <span class="op">=</span> <span class="va">icost</span><span class="op">/</span><span class="va">iqaly</span>,</span>
<span>    Real <span class="op">=</span> <span class="va">Nominal</span> <span class="op">/</span> <span class="va">pinfl</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Pivot to long so can be used in a graphic</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span></span>
<span>    cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Nominal"</span>, <span class="st">"Real"</span><span class="op">)</span>,</span>
<span>    names_to <span class="op">=</span> <span class="st">"Type"</span>,</span>
<span>    values_to <span class="op">=</span> <span class="st">"ICER"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>We should check at this point that the ICER we are starting at
($124,059) matches the scenario 2 ICER from earlier ($124,059).</p>
<p>The following plot shows the nominal ICER calculated at different
times, given the pricing, LoE and other assumptions. The horizontal
dotted line confirms that the initial ICER matches the value from
Scenario 2. The vertical dashed lines mark the timings of the LoEs of
first the standard of care, and then the new treatment.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot real and nominal present value over time</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">ds</span>,</span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">evaldate</span>, y <span class="op">=</span> <span class="va">ICER</span>, color<span class="op">=</span><span class="va">Type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Evaluation date"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="va">ds</span><span class="op">$</span><span class="va">ICER</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, linetype<span class="op">=</span><span class="st">'dotted'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">loe_new_start</span>, linetype<span class="op">=</span><span class="st">'dashed'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">loe_soc_start</span>, linetype<span class="op">=</span><span class="st">'dashed'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span></span>
<span>    labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/comma.html" class="external-link">comma</a></span>,</span>
<span>    limits<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">150000</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<p><img src="cost-effectiveness-applications_files/figure-html/calc_future-1.png" class="r-plt" alt="" width="700"></p>
</div>
<div class="section level2">
<h2 id="discussion">Discussion<a class="anchor" aria-label="anchor" href="#discussion"></a>
</h2>
<p>The findings for this example model are as follows:</p>
<ul>
<li><p>The effect of assuming dynamic pricing rather than flat pricing
over time is shown in the difference between results of scenarios 1 and
2. Scenario 1 assumed no increases in drug acquisition costs, but
inflationary increases in other costs. Scenario 2 additionally assumed
drug prices of the new intervention and SoC comparator would be eroded
due to losses of exclusivity. This has a modest impact on costs per
patient of the new intervention (reducing from $194,157 to $191,248).
Accordingly the ICER reduces from $126,451 to $124,059 per
QALY.</p></li>
<li><p>The effect of modeling uptake dynamically rather than just the
current cohort of patients is shown in the difference between results of
scenarios 1 and 3. Dynamic modeling of uptake has the effect of
weighting the costs and QALYs per patient in scenario 3 towards a later
cohort of patients, where the accumulation of costs and QALYs over the
time remaining in the payer’s 20 year time horizon will be less. The
incremental costs per patient reduced from $194,157 in scenario 1 to
$130,380 in scenario 3, whereas the incremental QALYs reduced from 2.08
to 1.319 per patient. Overall, the ICER increased from $126,451 to
$149,782 per QALY.</p></li>
<li><p>The effects of dynamic pricing and dynamic uptake are extremely
synergistic. Scenario 4 illustrates the effects of both dynamic pricing
and cohort modeling. The results per patient are identical to scenario
3, except that the cost per patient of the new intervention reduces from
$130,380 to $92,391, due to the impact of dynamic pricing. The ICER in
this case is reduced considerably to $94,570 per QALY.</p></li>
<li><p>As shown in the Figure, the ICER increases a little at first, as
we approach the LoE of the standard of care comparator. After all, a
cheaper comparator will increase the incremental cost of the new
treatment. However, this is soon dwarfed by the effect of the LoE of the
new treatment, which occurs later. This reduces the ICER significantly
as the LoE approaches. Thereafter, the ICER is constant in real terms
(but increasing with price inflation in nominal terms).</p></li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Dominic Muston, Merck &amp; Co., Inc., Rahway, NJ, USA and its affiliates.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
